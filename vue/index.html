<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.rawgit.com/filipelinhares/ress/master/dist/ress.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.2/js/swiper.jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://fonts.cdnfonts.com/css/hvdtrial-brandon-grotesque" rel="stylesheet">
  <title>Vite App</title>
  <script>
    function route(uri) {
      return `http://localhost/api${uri}`
    }

    async function GET(uri) {

      try {
        res = await (await fetch(route(uri), {
          method: "GET",
          credentials: "include",

        })).json();

        if (!res.logged) {
          window.location.pathname = "/login";
        }

        return res;
      } catch (error) {
        alert("Error en " + uri + " GET");
        console.log(error)
      }
    }

    async function POST(uri, json) {

      if (typeof json !== "string") {
        json = JSON.stringify(json);
      }

      try {
        res = await (await fetch(route(uri), {
          method: "POST",
          credentials: "include",
          headers: {
            "Content-type": "application/json"
          },
          body: json
        })).json();

        if (uri != "/login" && uri != "/resgistro" && !res.logged) {
          window.location.pathname = "/login";
        }

        console.log(res);
        return res;
      } catch (error) {
        alert("Error en " + uri + " POST");
        console.log(error)
      }
    }
  </script>
</head>

<body>
  <div id="app"></div>
  <script type="module" src="/src/main.js"></script>
</body>

</html>