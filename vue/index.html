<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <link rel="icon"
    href="./src/components/img/Leonardo_Diffusion_XL_dibuja_un_logo_para_una_empresa_de_cerve_2__2_-ai-brush-removebg-2vzply9.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.2/js/swiper.jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://fonts.cdnfonts.com/css/hvdtrial-brandon-grotesque" rel="stylesheet">
  <title>KillerBeer</title>
  <script>
    function route(uri) {
      return `http://localhost/api${uri}`
    }

    async function GET(uri) {
      try {
        let res = await fetch(route(uri), {
          method: "GET",
          credentials: "include",
        })

        if (res.headers.get("Content-Type") != 'application/json') {
          console.log(await res.text());
          return false;
        }

        let json = await res.json();

        console.log(json);
        if (!json.logged) {
          window.location.pathname = "/login";
        }

        return json;
      } catch (error) {
        console.log("Error en " + uri + " GET");
        console.log(error)
      }
    }

    async function POST(uri, json) {

      if (typeof json !== "string") {
        json = JSON.stringify(json);
      }

      try {
        res = await fetch(route(uri), {
          method: "POST",
          credentials: "include",
          headers: {
            "Content-type": "application/json"
          },
          body: json
        })

        if (res.headers.get("Content-Type") != 'application/json') {
          console.log(await res.text());
          return false;
        }

        json = await res.json();

        if (uri != "/login" && uri != "/resgistro" && !json.logged) {
          window.location.pathname = "/login";
        }

        return json;
      } catch (error) {
        console.log("Error en " + uri + " POST");
        console.log(error)
      }
    }
  </script>
</head>

<body class="container-fluid m-0 p-0">
  <div id="app"></div>
  <script type="module" src="/src/main.js"></script>
</body>

<style>
  #app {
    background-color: #212226;
  }
</style>

</html>